{% extends "layout.html" %} 
{% load i18n %} 

 

{% block content %}

<script>
    Highcharts.setOptions(
            {% include "publis/charts/options.json" %}
    );
 </script>
 
 {% if collections %}
 
<div> 
Voici la liste des collections HAL. Le tableau ci-dessous ou le menu local vous permettent
de consulter le détail d'une collection.
</div>


 <div>
<table>
<tr><th>Code</th><th>Nom</th><th>Nom Hal</th><th>Indicateurs</th><th>Actions</th></tr>
{% for coll in collections %}
<tr>
<td>{{coll.code}}</td><td>{{coll.nom}}</td><td>{{coll.sigle_hal}}</td><td>Nb publis: {{coll.nb_publis}}</td>
<td>
<ul>
{% if user.is_superuser %}
 <li><a href="{% url 'admin:publis_collection_change' coll.id %}">Modifier</a></li>
{% endif %}
 <li><a href="{% url 'publis:collections' %}?synchro=1&code={{coll.code}}">Synchroniser avec Hal</a></li>
 <li><a href="{% url 'publis:classement' coll.code %}">Classer les publications</a></li>
 <li><a href="{% url 'publis:stats_collection' coll.code %}">Statistiques </a></li>
</ul>
</td>
</tr>
{% endfor %}
</table>
</div>

<h3>Statistiques générales sur les collections</h3>

<div>
<table width="400">
<tr>
<td  width="50%"></td>
<td  width="50%"></td>

</tr>
<tr>
<td>
<div id="stats_revues_par_collection"></div>
 <script>
    Highcharts.chart('stats_revues_par_collection', 
       {% include "publis/charts/diagramme_camembert.json" with chart_titre='Répartition revues par collection' chart_donnees=stats_revues_par_collection|safe %}
    );
 </script>
</td>
<td width="33%"> <div id="stats_confs_par_collection"></div>
<script>
    Highcharts.chart('stats_confs_par_collection', 
       {% include "publis/charts/diagramme_camembert.json" with chart_titre='Répartition conférences par collection'  chart_donnees=stats_confs_par_collection|safe %}
    );
 </script>
 </td>
</tr>
<tr>
 <td colspan='2' width="100%"> 
<div id="stats_annee_type"></div>
 <script>
    Highcharts.chart('stats_annee_type', 
       {% include "publis/charts/diagramme_barres.json" with chart_annees=annees  chart_donnees=stats_annee_type %}
    );
 </script>
 </td>
</tr>
</table>

</div>
{% else %}
<div>
Vous n'avez pas encore défini de collection. Voici un 
<a  href="{% url 'admin:publis_collection_add' %}">lien pour créer votre
première collection.</a> 
</div>
{% endif %}


{% endblock content %}
